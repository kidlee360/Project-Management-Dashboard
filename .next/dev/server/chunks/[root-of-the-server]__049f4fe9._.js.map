{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Downloads/test/gemini-next-app/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  user: process.env.PGSQL_USER,\n  password: process.env.PGSQL_PASSWORD,\n  host: process.env.PGSQL_HOST,\n  port: process.env.PGSQL_PORT ? parseInt(process.env.PGSQL_PORT, 10) : undefined,\n  database: process.env.PGSQL_DATABASE,\n});\n\nexport default pool;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,OAAO,IAAI,qGAAI,CAAC;IACpB,MAAM,QAAQ,GAAG,CAAC,UAAU;IAC5B,UAAU,QAAQ,GAAG,CAAC,cAAc;IACpC,MAAM,QAAQ,GAAG,CAAC,UAAU;IAC5B,MAAM,QAAQ,GAAG,CAAC,UAAU,GAAG,SAAS,QAAQ,GAAG,CAAC,UAAU,EAAE,MAAM;IACtE,UAAU,QAAQ,GAAG,CAAC,cAAc;AACtC;uCAEe","debugId":null}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Downloads/test/gemini-next-app/pages/api/tasks.ts"],"sourcesContent":["// pages/api/tasks.js (Requires the 'pages/api' folder structure)\r\nimport db from '@/lib/db';\r\nimport type { NextApiRequest, NextApiResponse } from 'next'; \r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  if (req.method === 'GET') {\r\n    try {\r\n      const userId = 1;\r\n      const result = await db.query(\r\n        'SELECT * FROM tasks WHERE user_id = $1 ORDER BY id ASC',\r\n        [userId]\r\n      );\r\n      // ðŸ’¡ Fix: Use the standard Pages Router method for JSON response\r\n      res.status(200).json(result.rows); \r\n    } catch (error) {\r\n      console.error('Database Error:', error);\r\n      res.status(500).json({ error: 'Failed to fetch tasks.' });\r\n    }\r\n  } else if (req.method === 'POST') {\r\n    try {\r\n      const [ task, description, due_date, columnname, priority ] = req.body;\r\n      const userId = 1;\r\n        const result = await db.query(\r\n        'INSERT INTO tasks (task, description, due_date, columnname, priority, user_id) VALUES ($1, $2, $3, $4, $5, $6) RETURNING *',\r\n        [task, description, due_date, columnname, priority, userId]\r\n      );\r\n      res.status(201).json(result.rows[0]);\r\n    } catch (error) {\r\n      console.error('Database Error:', error);\r\n      res.status(500).json({ error: 'Failed to create task.' });\r\n    }\r\n  } else if(req.method === 'PUT'){\r\n    try {\r\n        const { id, task, description, due_date, columnname, priority } = req.body;\r\n        const userId = 1;\r\n        const result = await db.query(\r\n            'UPDATE tasks SET task = $1, description = $2, due_date = $3, columnname = $4, priority = $5 WHERE id = $6 RETURNING *',\r\n            [task, description, due_date, columnname, priority, id]\r\n        );\r\n            res.status(200).json(result.rows[0])\r\n    } catch (error){\r\n        console.error('Database Error:', error);\r\n        res.status(500).json({ error: 'Failed to update task.' });\r\n    }\r\n  } else if(req.method === 'DELETE'){\r\n    try {\r\n        // 1. Get the task ID from the request body\r\n        // Note: DELETE requests typically send data in the body or query params.\r\n        // Sending in the body (req.body) is often cleaner for complex data.\r\n        const { id } = req.body; \r\n        const userId = 1; // Assuming auth checks later\r\n\r\n        // 2. Execute the PostgreSQL DELETE command\r\n        const result = await db.query(\r\n            'DELETE FROM tasks WHERE id = $1 AND user_id = $2 RETURNING id',\r\n            [id, userId] // Use parameterized query for security\r\n        );\r\n\r\n        // 3. Check if a row was actually deleted\r\n        if (result.rowCount === 0) {\r\n            // Task not found or not owned by the user\r\n            return res.status(404).json({ error: 'Task not found or unauthorized.' });\r\n        }\r\n\r\n        // 4. Send a success response (typically status 204 or the ID of the deleted item)\r\n        // 200 is also acceptable if you want to send JSON back.\r\n        res.status(200).json({ id: id, message: 'Task deleted successfully.' });\r\n\r\n    } catch (error) {\r\n        console.error('Database Delete Error:', error);\r\n        res.status(500).json({ error: 'Failed to delete task.' });\r\n    }\r\n  } else if (req.method === 'PATCH') {\r\n    try {\r\n        const { id, columnname } = req.body;\r\n        if (!id || !columnname) {\r\n            return res.status(400).json({ error: 'Task ID and column name are required.' });\r\n        }\r\n        const result = await db.query(\r\n            'UPDATE tasks SET columnname = $1 WHERE id = $2 RETURNING *',\r\n            [columnname, id]\r\n        );\r\n        if (result.rowCount === 0) {\r\n            return res.status(404).json({ error: 'Task not found.' });\r\n        }\r\n        res.status(200).json(result.rows[0]);\r\n    } catch (error) {\r\n        console.error('Database Error:', error);\r\n        res.status(500).json({ error: 'Failed to update task column.' });\r\n    }\r\n  } else {\r\n    // Handle other methods like POST, PUT, DELETE\r\n    res.setHeader('Allow', ['GET', 'POST', 'PUT', 'DELETE', 'PATCH']);\r\n    res.status(405).end(`Method ${req.method} Not Allowed`);\r\n  }\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}